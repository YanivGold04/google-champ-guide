<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab Coordinate Picker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a1a;
            color: #fff;
            overflow: hidden;
        }
        
        #controls {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.9);
            padding: 15px;
            z-index: 1000;
            display: flex;
            gap: 15px;
            align-items: center;
            border-bottom: 2px solid #667eea;
        }
        
        #controls input[type="file"] {
            padding: 8px 15px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
        
        #controls input[type="text"] {
            flex: 1;
            padding: 8px 15px;
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 6px;
            color: white;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }
        
        #copyBtn {
            padding: 8px 20px;
            background: #10b981;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }
        
        #copyBtn:hover {
            background: #059669;
        }
        
        #clearBtn {
            padding: 8px 20px;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
        
        #clearBtn:hover {
            background: #dc2626;
        }
        
        #imageContainer {
            position: absolute;
            top: 70px;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: auto;
        }
        
        #targetImage {
            max-width: 100%;
            max-height: 100%;
            display: none;
            position: relative;
        }
        
        #overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            cursor: crosshair;
            display: none;
        }
        
        #selectionBox {
            position: absolute;
            border: 2px solid #667eea;
            background: rgba(102, 126, 234, 0.2);
            pointer-events: none;
            display: none;
        }
        
        #coordinates {
            position: absolute;
            background: #667eea;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 11px;
            font-family: 'Courier New', monospace;
            pointer-events: none;
            white-space: nowrap;
            display: none;
        }
        
        #placeholder {
            text-align: center;
            color: #666;
        }
        
        #placeholder h2 {
            margin-bottom: 10px;
            color: #999;
        }
        
        .success-toast {
            position: fixed;
            top: 80px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 15px 25px;
            border-radius: 6px;
            font-weight: 600;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s;
            z-index: 2000;
        }
        
        .success-toast.show {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>
<body>
    <div id="controls">
        <input type="file" id="imageUpload" accept="image/*">
        <input type="text" id="outputStyle" readonly placeholder="Select an area on the image...">
        <button id="copyBtn">Copy</button>
        <button id="clearBtn">Clear</button>
    </div>
    
    <div id="imageContainer">
        <div id="placeholder">
            <h2>ðŸ“¸ Lab Coordinate Picker</h2>
            <p>Upload a screenshot to start measuring coordinates</p>
        </div>
        <img id="targetImage" alt="Target">
        <div id="overlay"></div>
        <div id="selectionBox"></div>
        <div id="coordinates"></div>
    </div>
    
    <div id="successToast" class="success-toast">âœ“ Copied to clipboard!</div>
    
    <script>
        const imageUpload = document.getElementById('imageUpload');
        const targetImage = document.getElementById('targetImage');
        const overlay = document.getElementById('overlay');
        const selectionBox = document.getElementById('selectionBox');
        const coordinates = document.getElementById('coordinates');
        const outputStyle = document.getElementById('outputStyle');
        const copyBtn = document.getElementById('copyBtn');
        const clearBtn = document.getElementById('clearBtn');
        const placeholder = document.getElementById('placeholder');
        const successToast = document.getElementById('successToast');
        
        let isDrawing = false;
        let startX, startY;
        let imageRect;
        
        imageUpload.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    targetImage.src = event.target.result;
                    targetImage.style.display = 'block';
                    placeholder.style.display = 'none';
                    overlay.style.display = 'block';
                    
                    // Update image rect after load
                    targetImage.onload = () => {
                        updateImageRect();
                    };
                };
                reader.readAsDataURL(file);
            }
        });
        
        function updateImageRect() {
            imageRect = targetImage.getBoundingClientRect();
            overlay.style.top = imageRect.top + 'px';
            overlay.style.left = imageRect.left + 'px';
            overlay.style.width = imageRect.width + 'px';
            overlay.style.height = imageRect.height + 'px';
        }
        
        window.addEventListener('resize', updateImageRect);
        window.addEventListener('scroll', updateImageRect);
        
        overlay.addEventListener('mousedown', (e) => {
            if (!imageRect) updateImageRect();
            
            isDrawing = true;
            startX = e.clientX - imageRect.left;
            startY = e.clientY - imageRect.top;
            
            selectionBox.style.display = 'block';
            selectionBox.style.left = startX + 'px';
            selectionBox.style.top = startY + 'px';
            selectionBox.style.width = '0px';
            selectionBox.style.height = '0px';
            
            coordinates.style.display = 'none';
        });
        
        overlay.addEventListener('mousemove', (e) => {
            if (!isDrawing) return;
            
            const currentX = e.clientX - imageRect.left;
            const currentY = e.clientY - imageRect.top;
            
            const left = Math.min(startX, currentX);
            const top = Math.min(startY, currentY);
            const width = Math.abs(currentX - startX);
            const height = Math.abs(currentY - startY);
            
            selectionBox.style.left = left + 'px';
            selectionBox.style.top = top + 'px';
            selectionBox.style.width = width + 'px';
            selectionBox.style.height = height + 'px';
            
            // Show live coordinates
            const topPercent = ((top / imageRect.height) * 100).toFixed(2);
            const leftPercent = ((left / imageRect.width) * 100).toFixed(2);
            const widthPercent = ((width / imageRect.width) * 100).toFixed(2);
            const heightPercent = ((height / imageRect.height) * 100).toFixed(2);
            
            coordinates.textContent = `top:${topPercent}% left:${leftPercent}% width:${widthPercent}% height:${heightPercent}%`;
            coordinates.style.display = 'block';
            coordinates.style.left = (left) + 'px';
            coordinates.style.top = (top - 30) + 'px';
        });
        
        overlay.addEventListener('mouseup', (e) => {
            if (!isDrawing) return;
            isDrawing = false;
            
            const currentX = e.clientX - imageRect.left;
            const currentY = e.clientY - imageRect.top;
            
            const left = Math.min(startX, currentX);
            const top = Math.min(startY, currentY);
            const width = Math.abs(currentX - startX);
            const height = Math.abs(currentY - startY);
            
            if (width > 5 && height > 5) {
                const topPercent = ((top / imageRect.height) * 100).toFixed(2);
                const leftPercent = ((left / imageRect.width) * 100).toFixed(2);
                const widthPercent = ((width / imageRect.width) * 100).toFixed(2);
                const heightPercent = ((height / imageRect.height) * 100).toFixed(2);
                
                outputStyle.value = `style="top:${topPercent}%; left:${leftPercent}%; width:${widthPercent}%; height:${heightPercent}%;"`;
            }
        });
        
        copyBtn.addEventListener('click', () => {
            if (outputStyle.value) {
                navigator.clipboard.writeText(outputStyle.value).then(() => {
                    successToast.classList.add('show');
                    setTimeout(() => {
                        successToast.classList.remove('show');
                    }, 2000);
                });
            }
        });
        
        clearBtn.addEventListener('click', () => {
            selectionBox.style.display = 'none';
            coordinates.style.display = 'none';
            outputStyle.value = '';
        });
        
        // Allow escape to clear
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                clearBtn.click();
            }
        });
    </script>
</body>
</html>